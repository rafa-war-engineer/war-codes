<!DOCTYPE html>
<html lang="en">

<head>
  <title>Weather Station</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="bootstrap.min.css">
  <link rel="stylesheet" href="blanqui.css">
  <script src="https://code.highcharts.com/highcharts.js"></script>
</head>

<!-- jumbotron "https://i.ibb.co/4N8XXjh/frame7.png" -->

<body>

  <div class="container">
    <style>
      .jumbotron {
        background: url("https://i.ibb.co/RH3ssCR/frame7.png");
        height: 100%;
        /* You must set a specified height */
        background-position: left bottom;
        /* Center the image */
        background-repeat: no-repeat;
        /* Do not repeat the image */
        background-size: cover;
      }
    </style>
    <div class="jumbotron" id="webhome">
      <h1 class="text-right"> Weather Station</h1>
      <h5 class="text-right">Personal weather station based on sensor Bosch BME680</h5>
    </div>
  </div>
  <!----------------------------------------------------------->
  <!-- Nav bar -->

  <!-- <div class="container"> -->
  <nav class="navbar navbar-expand-sm bg-dark navbar-dark sticky-top">
    <!-- <a class="navbar-brand" href="#">WebSiteName</a> -->
    <!-- <a class="navbar-brand" id="hora">Logo</a> -->
    <ul class="navbar-nav mr-auto">
      <li class="nav-item">
        <a class="nav-link" href="#webhome">Home</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="#gotocharts">Charts</a>
      </li>
    </ul>
    <!-- <ul class="nav navbar-nav"> -->
    <!-- <li class="active"><a href="#webhome">Home</a></li> -->
    <!-- <li class="active"><a href="#placecharts">Charts</a></li> -->
    <!-- <li><a href="#webshome">Page 1</a></li>
        <li><a href="#">Page 2</a></li> -->
    <!-- </ul> -->
    <ul class="nav navbar-nav">
      <!-- <li><a href="#"><span class="glyphicon glyphicon-user"></span> Sign Up</a></li> -->
      <!-- <li><a href="#">About</a></li> -->
      <!-- <li><a data-toggle="modal" data-target="#myModal">About sensors</a></li> -->
      <span class="navbar-text" data-toggle="modal" data-target="#myModalAbout">About sensors</span>

    </ul>
    <!-- ------- -->
    <!-- Modal -->
    <!-- ------- -->
  </nav>

  <!-- START MODAL ABOUT -->
  <div class="modal fade" id="myModalAbout">
    <div class="modal-dialog">

      <!-- Modal content-->
      <style>
        .modal-header {
          background-color: #00AA9E
        }

        .modal-footer {
          background-color: #000000
        }
      </style>
      <div class="modal-content">
        <div class="modal-header">
          <!-- <button type="button" class="close" data-dismiss="modal">&times;</button> -->
          <h2 class="modal-title">Sensors</h2>
        </div>
        <div class="modal-body">
          <h4> Bosch BME680 </h4>
          <p>The BME680 is a digital 4-in-1 sensor with gas, humidity,
            pressure and temperature measurement based on proven sensing
            principles. The sensor module is housed in an extremely compact
            metal-lid LGA package with a footprint of only 3.0 × 3.0 mm2 with
            a maximum height of 1.00 mm (0.93 ± 0.07 mm). Its small dimensions
            and its low power consumption enable the integration in battery-powered
            or frequency-coupled devices, such as handsets or wearables.</p>
          <h4> Zhengzhou Winsen MH-Z19B NDIR CO2 </h4>
          <p>MH-Z19B NDIR infrared gas module is a common type, small size
            sensor, using non-dispersive infrared (NDIR) principle to detect
            the existence of CO2 in the air, with good selectivity,
            non-oxygen dependent and long life. Built-in temperature compensation;
            and it has UART output and PWM output. It is developed by the
            tight integration of mature infrared absorbing gas detection
            technology, precision optical circuit design and superior
            circuit design.</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
        </div>
      </div>

    </div>
  </div>
  <!-- ENDS MODAL ABOUT -->



  <!-- ALERT BAR START -->
  <div class="container">

    <style>
      .alert-custom {
        background-color: #D1E8E3;
        color: #000000;
      }
    </style>

    <div class="alert alert-custom show" role="alert">
      <strong>Last update:</strong> <span id="hora">XXXX</span>
      <span style="float:right;" id="text_status"> MMMMMMMMM </span>
      <span style="float:right;"><strong> Status: </strong></span>
    </div>

  </div>







  <!-- ALERT BAR END -->

  <!-- QUITAR, EN LO QUE DESCUBRO COMO CAMBIAR EL COLOR -->
  <!-- <input type="hidden" id="iaq_color"> -->
  <!-- ************************************************ -->

  <div class="container">
    <div class="col d-flex justify-content-center">

      <div class="card-columns mx-auto d-flex justify-content-center col-8">



        <div class="card-columns">


          <div class="card text-center border-dark mt-3 mb-3" style="max-width: 18rem;">
            <div class="card-header text-white bg-dark">
              <h2> <small>Temperature</small></h2>
            </div>

            <div class="card-body text-dark">
              <div class="forecast">
                Next 12H: <span id="forecast">
              </div>
              <div class="temp">
                <!-- <img src="https://s5.postimg.cc/yzcm7htyb/image.png" alt="" width="40"> -->
                <img src="" id="dinamyc_image" alt="" width="60">
                <!-- <h3 id="weather_img"> -->
                <h2 id="temp">
              </div>
              <img src="aachen.png" alt="" width="120">
              <!-- <h2 class="card-title" id="forecast"></h2> original -->
              <h2 class="card-title"></h2>

            </div>
          </div>


          <!-- <input type="hidden" id="weather_img"> -->
          <img id="weather_img">



          <div class="card text-center border-dark mt-3 mb-3" style="max-width: 18rem;">
            <div class="card-header text-white bg-dark">
              <h2> <small>Pressure</small></h2>
            </div>
            <div class="card-body text-dark">
              <h2 class="card-title" id="pres"></h2>
            </div>
          </div>



          <div class="card text-center border-dark mt-3 mb-3" style="max-width: 18rem;">
            <div class="card-header text-white bg-dark">
              <h2> <small>Rel. Humidity</small></h2>
            </div>
            <div class="card-body text-dark">
              <h2 class="card-title" id="hum"></h2>
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>



  <!-- tarjetas de iaq y co2 -->
  <div class="container">
    <div class="col d-flex justify-content-center">
      <div class="card-deck">
        <div class="card text-center border-dark mt-3 mb-3" style="min-width: 22rem;">
          <!-- <div class="card-header text-white bg-dark"> -->
          <div id="dynamic_header" class="card-header text-white" style="background-color: #00AA9E ;">
            <h2 id="dynamic_text"> <small>Air Quality Index</small></h2>
          </div>
          <div class="card-body text-dark">
            <h2 class="card-title" id="iaq_number">xxx</h2>
            <p id="iaq_quality">xxx</p>
            <input type="hidden" id="iaq_color">
            <!-- <p id="iaq_quality">xxx</p> -->
            <p><small class="text-muted" id="iaq_accuracy">xxx</small></p>
            <!-- <h6 id="iaq_accuracy">ssf</h6> -->
            <h6><strong>Impact:</strong></h6>
            <p id="iaq_impact">xxx</p>
            <h6><strong>Action suggested:</strong></h6>
            <p id="iaq_suggested">xxx</p>
            <a href="#" class="card-link" data-toggle="modal" data-target="#myModalIAQ">Info</a>
            <a href="#gotocharts" class="card-link" id="gotoIAQChart">Chart</a>
          </div>
        </div>

        <div class="card text-center border-dark mt-3 mb-3" style="min-width: 22rem;">
          <div class="card-header text-white bg-dark">
            <h2> <small>CO<sub>2</sub></small></h2>
          </div>
          <div class="card-body text-dark">
            <h2 class="card-title" id="co2_mess">xxx</h2>
            <!-- <h5 class="card-title" id="co2_stimation">xxx</h5> -->
            <h6><strong>Action suggested:</strong></h6>
            <p id="co2_sugested">lllllll</p>
            <p class="card-title" id="co2_stimation">xxx</p>
            <!-- <h6 class="card-title" id="co2_accuracy">xxx</h6> -->
            <p><small class="text-muted" id="co2_accuracy">xxx</small></p>

            <a href="#gotocharts" class="card-link" id="gotoCO2Chart">Chart</a>
          </div>
        </div>
      </div>

    </div>
  </div>

  <!-- START MODAL IAQ -->
  <div class="modal fade" id="myModalIAQ">
    <div class="modal-dialog">

      <!-- Modal content-->
      <style>
        .modal-header {
          background-color: #00AA9E
        }

        .modal-footer {
          background-color: #000000
        }
      </style>
      <div class="modal-content">
        <div class="modal-header">
          <!-- <button type="button" class="close" data-dismiss="modal">&times;</button> -->
          <h2 class="modal-title">IAQ</h2>
        </div>
        <div class="modal-body">
          <h4> Air Quality Index </h4>
          <p>The BME680 is a metal oxide-based sensor that detects VOCs by adsorption (and subsequent oxidation/reduction) on its sensitive layer. Thus, the BME680 reacts to most volatile organic compounds as well as many other gases polluting indoor
            air (one exception is for instance CO2). In contrast to sensors which are selective for one specific component, the BME680 is capable of measuring the sum of nearly all VOCs/contaminants in the surrounding air. This enables the BME680 to
            detect e.g. outgassing from paint, furniture and/or garbage, high VOC levels due to cooking, food consumption, exhaled breath and/or sweating.</p>
          <p>As a raw signal, the BME680 will output gas sensor resistance values and its changes due to varying gas concentrations (the higher the concentration of reducing VOCs, the lower the resistance and vice versa). Since this raw signal is
            influenced as well by parameters other than VOC concentration (e.g. humidity level), the raw values are transformed to an index for air quality (IAQ) by smart algorithms inside BSEC.</p>
          <p>The IAQ scale ranges from 0 (clean air) to 500 (heavily polluted air). During operation, the algorithms automatically calibrate and adapt themselves to the typical environments where the sensor is operated (e.g., home, workplace, inside
            a car, etc.). This automatic background calibration ensures that users experience consistent IAQ performance. The calibration process considers the recent measurement history (typ. up to four days, adjustable by BSEC config string) to
            ensure that IAQ ~ 25 corresponds to “typical good” air and IAQ ~ 250 indicates “typical polluted” air.</p>

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
        </div>
      </div>

    </div>
  </div>
  <!-- ENDS MODAL IAQ -->


  <!-- tarjetas de breat voc y gas percentage -->
  <div class="container">
    <div class="col d-flex justify-content-center">
      <div class="card-deck">
        <div class="card text-center border-dark mt-3 mb-3" style="min-width: 20rem;">
          <div class="card-header text-white bg-dark">
            <h2> <small>Breath VOC </small></h2>
          </div>
          <div class="card-body text-dark">
            <h2 class="card-title" id="breath_voc">xxx</h2>
            <p><small class="text-muted" id="breath_voc_accuracy">xxx</small></p>
            <a href="#" class="card-link" data-toggle="modal" data-target="#myModalbVOC">Info</a>
            <a href="#gotocharts" class="card-link" id="gotobVOCChart">Chart</a>
          </div>
        </div>


        <!-- Empieza tarjeta de porcentaje de gas -->
        <div class="card text-center border-dark mt-3 mb-3" style="min-width: 20rem;">
          <div class="card-header text-white bg-dark">
            <h2> <small>Gas percentage</small></h2>
          </div>
          <div class="card-body">
            <h2 class="card-title" id="gaspercent">xxx</h2>
            <!-- <p id="gaspercent"></p> -->
            <!-- -- start radial progresss -- -->
            <!-- -- end radial progresss -- -->
            <p><small class="text-muted" id="gaspercent_accuracy">xxx</small></p>

            <a href="#" class="card-link" data-toggle="modal" data-target="#myModalgas">Info</a>
          </div>
        </div>
        <!-- termina tarjeta de porcentaje de gas -->
      </div>
    </div>
  </div>


  <!-- START MODAL breathVOC -->
  <div class="modal fade" id="myModalbVOC">
    <div class="modal-dialog">

      <style>
        .modal-header {
          background-color: #00AA9E
        }

        .modal-footer {
          background-color: #000000
        }
      </style>
      <div class="modal-content">
        <div class="modal-header">
          <!-- <button type="button" class="close" data-dismiss="modal">&times;</button> -->
          <h2 class="modal-title">b-VOC</h2>
        </div>
        <div class="modal-body">
          <h4> breath-VOC </h4>
          <p>Conversion into breath-VOC equivalents in ppm concentration. The scaling is derived from lab tests with the b-VOC gas mixture described in table below.</p>
          <table class="table table-bordered">
            <thead>
              <tr>
                <th>Molar Fraction</th>
                <th>Compound</th>
                <th>Production Tolerance</th>
                <th>Certified Accuracy</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>5 ppm</td>
                <td>Ethane</td>
                <td>20%</td>
                <td>5%</td>
              </tr>
              <tr>
                <td>10 ppm</td>
                <td>Isoprene /2-methyl-1,3 Butadiene</td>
                <td>20%</td>
                <td>5%</td>
              </tr>
              <tr>
                <td>10 ppm</td>
                <td>Ethanol</td>
                <td>20%</td>
                <td>5%</td>
              </tr>
              <tr>
                <td>50 ppm</td>
                <td>Acetone</td>
                <td>20%</td>
                <td>5%</td>
              </tr>
              <tr>
                <td>15 ppm</td>
                <td>Carbon Monoxide</td>
                <td>10%</td>
                <td>2%</td>
              </tr>
            </tbody>
          </table>
          <p>Besides ethanol (EtOH) as a target test gas, the sensors are also tested with breath-VOC (b-VOC). The b-VOC mixture, as listed above, represents the most important compounds in an exhaled breath of healthy humans. The values are
            derived from several publications on breath analysis studies. The composition does not contain species which would chemically react to ensure that the mixture is stable for at least 6 months. Furthermore, the composition is also limited
            to species which can be manufactured in one mixture.</p>

        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
        </div>
      </div>

    </div>
  </div>
  <!-- ENDS MODAL breathVOC -->


  <!-- START MODAL gas percentage -->
  <div class="modal fade" id="myModalgas">
    <div class="modal-dialog">

      <style>
        .modal-header {
          background-color: #00AA9E
        }

        .modal-footer {
          background-color: #000000
        }
      </style>
      <div class="modal-content">
        <div class="modal-header">
          <!-- <button type="button" class="close" data-dismiss="modal">&times;</button> -->
          <h2 class="modal-title">Gas percentage</h2>
        </div>
        <div class="modal-body">
          <p>Alternative indicator for air pollution which rates the current raw gas sensor resistance value based on the individual sensor history:</p>
          <p>0% = “lowest air pollution ever measured”</p>
          <p>100% = “highest air pollution level ever measured”</p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
        </div>
      </div>

    </div>
  </div>
  <!-- ENDS MODAL gas percentage -->
  <br id="gotocharts">
  <br>
  <br>
  <!-- este es el pendejo carousel -->
  <div class="container text-center">
    <h1> Charts </h1>
    <div id="carouselExampleIndicators" class="carousel slide" data-interval="false" data-ride="carousel">
      <ol class="carousel-indicators">
        <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
        <li data-target="#carouselExampleIndicators" data-slide-to="1"></li>
        <li data-target="#carouselExampleIndicators" data-slide-to="2"></li>
        <li data-target="#carouselExampleIndicators" data-slide-to="3"></li>
      </ol>
      <div class="carousel-inner">
        <div class="carousel-item active">
          <div id="chart-temperature" class="container"></div><br>
          <!-- <img class="d-block w-100" src="..." alt="First slide"> -->
        </div>
        <div class="carousel-item">
          <div id="chart-IAQ" class="container"></div><br>
          <!-- <img class="d-block w-100" src="..." alt="Second slide"> -->
        </div>
        <div class="carousel-item">
          <div id="chart-co2" class="container"></div><br>
          <!-- <img class="d-block w-100" src="..." alt="Third slide"> -->
        </div>
        <div class="carousel-item">
          <div id="chart-breathvoc" class="container"></div><br>
          <!-- <img class="d-block w-100" src="..." alt="Third slide"> -->
        </div>
      </div>
      <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="false"></span>
        <span class="sr-only">Previous</span>
      </a>
      <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="false"></span>
        <span class="sr-only">Next</span>
      </a>
    </div>
  </div>
  <!-- Termina carousel -->


  <!-- <input type="hidden" id="textdummy"> -->
  <!-- <p><small class="text-muted" id="textdummy">xxx</small></p> -->


  <!-- Empieza footer -->
  <div class="container-fluid pb-0 mb-0 justify-content-center text-light ">

    <style>
      .container-fluid {
        overflow: hidden;
        margin-top: 50px;
        background: #343a40;
        color: #9a9da0 !important;
        margin-bottom: 0;
        padding-bottom: 0
      }

      .bold-text {
        /* color: #989c9e !important */
        color: #D1E8E3 !important
      }
    </style>

    <footer>
      <div class="row my-5 justify-content-center py-5">
        <div class="col-11">
          <div class="row ">
            <div class="col-xl-8 col-md-4 col-sm-4 col-12 my-auto mx-auto a">
              <h2 class="text-muted mb-md-0 mb-3 bold-text">Wheater Station.</h2>
              <h3 class="text-muted mb-md-0 mb-3 bold-text">FH Aachen.</h3>
            </div>
            <div class="col-xl-2 col-md-4 col-sm-4 col-12">
              <!-- <h6 class="mb-3 mb-lg-4 bold-text "><b>Menu</b></h6>
              <ul class="list-unstyled">
                <!-- <a class="nav-link" href="#gotocharts">Charts</a> -->
              <!-- <li href="#webhome">Home</li>
                <li href="#gotocharts">Charts</li>
                <li>About sensors</li>
              </ul> -->
            </div>
            <div class="col-xl-2 col-md-4 col-sm-4 col-12">
              <h6 class="mb-3 mb-lg-4 text-muted bold-text mt-sm-0 mt-5"><b>Address</b></h6>
              <p class="mb-1">Goethestraße 1 52064</p>
              <p>Aachen, DE</p>
            </div>
          </div>
          <div class="row ">
            <div class="col-xl-8 col-md-4 col-sm-4 col-auto my-md-0 mt-5 order-sm-1 order-3 align-self-end">
              <small class="rights"><span>&#174;</span> 2021 All Rights Reserved.</small>
            </div>
            <div class="col-xl-2 col-md-4 col-sm-4 col-auto order-1 align-self-end ">
              <!-- <h6 class="mt-55 mt-2 text-muted bold-text"><b>other contact</b></h6><small> <span><i class="fa fa-envelope" aria-hidden="true"></i></span> someother@gmail.com</small> -->
            </div>
            <div class="col-xl-2 col-md-4 col-sm-4 col-auto order-2 align-self-end mt-3 ">
              <h6 class="text-muted bold-text"><b>Contact</b></h6>
              <span><i class="fa fa-envelope" aria-hidden="true"></i> someone@gmail.com</small>
            </div>
          </div>
        </div>
      </div>
    </footer>
  </div>
  <!-- Termina footer -->

  <!-- scripts -->
  <script src="jquery.min.js"></script>
  <script src="bootstrap.min.js"></script>
  <!-- ********************* -->
  <script>
    $(document).ready(function() {

      // Go to the second item
      $("#gotoIAQChart").click(function() {
        $("#carouselExampleIndicators").carousel(1);
      });

      // Go to the third item
      $("#gotoCO2Chart").click(function() {
        $("#carouselExampleIndicators").carousel(2);
      });

      $("#gotobVOCChart").click(function() {
        $("#carouselExampleIndicators").carousel(3);
      });

    });
  </script>
  <!-- ********************* -->
  <!-- ********************* -->
  <!-- ********************* -->
  <!-- ********************* -->
  <!-- ********************* -->
</body>

<!-- script temperature -->
<script>
  var chartT = new Highcharts.Chart({
    chart: {
      renderTo: 'chart-temperature',
      backgroundColor: '#D1E8E3'
    },
    title: {
      text: 'BME680 Temperature Chart'
    },
    series: [{
      showInLegend: false,
      data: []
    }],
    plotOptions: {
      line: {
        animation: true,
        dataLabels: {
          enabled: true
        }
      },
      series: {
        color: '#00AA9E'
      }
    },
    xAxis: {
      type: 'datetime',
      dateTimeLabelFormats: {
        second: '%H:%M:%S'
      }
    },
    yAxis: {
      gridLineColor: '#cacaca',
      title: {
        text: 'Temperature in Celsius'
      }
    },
    credits: {
      enabled: false
    }
  });
  setInterval(function() {
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
      if (this.readyState == 4 && this.status == 200) {
        var x = (new Date()).getTime(),
          y = parseFloat(this.responseText);

        if (chartT.series[0].data.length > 40) {
          chartT.series[0].addPoint([x, y], true, true, true);
        } else {
          chartT.series[0].addPoint([x, y], true, false, true);
        }
      }
    };
    xhttp.open("GET", "/temperature", true);
    xhttp.send();
  }, 3000);
</script>


<!-- **********start script second chart*********** -->
<script>
  var chartI = new Highcharts.Chart({
    chart: {
      renderTo: 'chart-IAQ',
      backgroundColor: '#D1E8E3'
    },
    title: {
      text: 'BME680 IAQ Chart'
    },
    series: [{
      showInLegend: false,
      data: []
    }],
    plotOptions: {
      line: {
        animation: false,
        dataLabels: {
          enabled: true
        }
      },
      series: {
        color: '#00AA9E'
      }
    },
    xAxis: {
      type: 'datetime',
      dateTimeLabelFormats: {
        second: '%H:%M:%S'
      }
    },
    yAxis: {
      gridLineColor: '#cacaca',
      title: {
        text: 'IAQ Level'
      }
    },
    credits: {
      enabled: false
    }
  });
  setInterval(function() {
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
      if (this.readyState == 4 && this.status == 200) {
        var x = (new Date()).getTime(),
          y = parseFloat(this.responseText);

        if (chartI.series[0].data.length > 40) {
          chartI.series[0].addPoint([x, y], true, true, true);
        } else {
          chartI.series[0].addPoint([x, y], true, false, true);
        }
      }
    };
    xhttp.open("GET", "/iaq", true);
    xhttp.send();
  }, 3000);
</script>
<!-- ********** end script second chart *********** -->

<!-- ***********start script third chart********** -->
<script>
  var chartP = new Highcharts.Chart({
    chart: {
      renderTo: 'chart-co2',
      backgroundColor: '#D1E8E3'
    },
    title: {
      text: 'MH-Z19B CO2 level'
    },
    series: [{
      showInLegend: false,
      data: []
    }],
    plotOptions: {
      line: {
        animation: false,
        dataLabels: {
          enabled: true
        }
      },
      series: {
        color: '#00AA9E'
      }
    },
    xAxis: {
      type: 'datetime',
      dateTimeLabelFormats: {
        second: '%H:%M:%S'
      }
    },
    yAxis: {
      gridLineColor: '#cacaca',
      title: {
        text: 'parts per million'
      }
    },
    credits: {
      enabled: false
    }
  });
  setInterval(function() {
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
      if (this.readyState == 4 && this.status == 200) {
        var x = (new Date()).getTime(),
          y = parseFloat(this.responseText);

        if (chartP.series[0].data.length > 40) {
          chartP.series[0].addPoint([x, y], true, true, true);
        } else {
          chartP.series[0].addPoint([x, y], true, false, true);
        }
      }
    };
    xhttp.open("GET", "/co2", true); //handler
    xhttp.send();
  }, 3000);
</script>
<!-- ***********end script third chart********** -->

<!-- ***********start script fourth chart********** -->
<script>
  var chartH = new Highcharts.Chart({
    chart: {
      renderTo: 'chart-breathvoc',
      backgroundColor: '#D1E8E3'
    },
    title: {
      text: 'BME680 Breath VOC estimation'
    },
    series: [{
      showInLegend: false,
      data: [],
      color: '#00AA9E'
    }],
    plotOptions: {
      line: {
        animation: false,
        dataLabels: {
          enabled: true
        }
      }
    },
    xAxis: {
      type: 'datetime',
      dateTimeLabelFormats: {
        second: '%H:%M:%S'
      }
    },
    yAxis: {
      gridLineColor: '#cacaca',
      title: {
        text: 'parts per million'
      }
    },
    credits: {
      enabled: false
    }
  });
  setInterval(function() {
    var xhttp = new XMLHttpRequest();
    xhttp.onreadystatechange = function() {
      if (this.readyState == 4 && this.status == 200) {
        var x = (new Date()).getTime(),
          y = parseFloat(this.responseText);

        if (chartH.series[0].data.length > 40) {
          chartH.series[0].addPoint([x, y], true, true, true);
        } else {
          chartH.series[0].addPoint([x, y], true, false, true);
        }
      }
    };
    xhttp.open("GET", "/breathvoc_h", true);
    xhttp.send();
  }, 3000);
</script>
<!-- ***********end script fourth chart********** -->
<!-- ********** starts Script reception data*********** -->
<script>
  function renew() {
    fetch('/info').then(function(response) {
      return response.json();
    }).then(function(array) {
      //console.log(array);
      var elem = document.querySelector('#temp');
      array[2] != 'nan' ? elem.innerHTML = array[0] + '°C' : elem.innerHTML = '---------';
      elem = document.querySelector('#pres');
      array[2] != 'nan' ? elem.innerHTML = array[1] + ' hPa' : elem.innerHTML = 'Fehler';
      elem = document.querySelector('#hum');
      array[2] != 'nan' ? elem.innerHTML = array[2] + ' %' : elem.innerHTML = '---------';
      elem = document.querySelector('#hora');
      array[2] != 'nan' ? elem.innerHTML = array[3] : elem.innerHTML = '---------';
      elem = document.querySelector('#text_status');
      array[2] != 'nan' ? elem.innerHTML = array[4] : elem.innerHTML = '---------';
      elem = document.querySelector('#co2_mess');
      array[2] != 'nan' ? elem.innerHTML = array[5] + ' ppm' : elem.innerHTML = '---------';
      elem = document.querySelector('#co2_stimation');
      array[2] != 'nan' ? elem.innerHTML = array[6] + ' ppm' : elem.innerHTML = '---------';
      elem = document.querySelector('#co2_accuracy');
      array[2] != 'nan' ? elem.innerHTML = array[7] : elem.innerHTML = '---------';
      elem = document.querySelector('#co2_sugested');
      array[2] != 'nan' ? elem.innerHTML = array[8] : elem.innerHTML = '---------';
      elem = document.querySelector('#breath_voc');
      array[2] != 'nan' ? elem.innerHTML = array[9] + ' ppm' : elem.innerHTML = '---------';
      elem = document.querySelector('#breath_voc_accuracy');
      array[2] != 'nan' ? elem.innerHTML = array[10] : elem.innerHTML = '---------';
      elem = document.querySelector('#gaspercent');
      array[2] != 'nan' ? elem.innerHTML = array[11] + ' %' : elem.innerHTML = '---------';
      elem = document.querySelector('#gaspercent_accuracy');
      array[2] != 'nan' ? elem.innerHTML = array[12] : elem.innerHTML = '---------';
      elem = document.querySelector('#iaq_number');
      array[2] != 'nan' ? elem.innerHTML = array[13] : elem.innerHTML = '---------';
      elem = document.querySelector('#iaq_accuracy');
      array[2] != 'nan' ? elem.innerHTML = array[14] : elem.innerHTML = '---------';
      elem = document.querySelector('#iaq_impact');
      array[2] != 'nan' ? elem.innerHTML = array[15] : elem.innerHTML = '---------';
      elem = document.querySelector('#iaq_suggested');
      array[2] != 'nan' ? elem.innerHTML = array[16] : elem.innerHTML = '---------';
      elem = document.querySelector('#iaq_color');
      array[2] != 'nan' ? elem.innerHTML = array[17] : elem.innerHTML = '---------';
      dynamic_header.style.backgroundColor = array[17];
      if (array[17] == "#FEFB3B" || array[17] == "#80E335") {
        dynamic_text.style.color = "black"
      } else {
        dynamic_text.style.color = "white"
      }
      elem = document.querySelector('#iaq_quality');
      array[2] != 'nan' ? elem.innerHTML = array[18] : elem.innerHTML = '---------';
      elem = document.querySelector('#forecast');
      array[2] != 'nan' ? elem.innerHTML = array[19] : elem.innerHTML = '---------';
      elem = document.querySelector('#weather_img');
      array[2] != 'nan' ? elem.innerHTML = array[20] : elem.innerHTML = '---------';
      const image = document.getElementById("dinamyc_image");
      image.src = array[20];

      // elem = document.querySelector('#textdummy');
      // array[2] != 'nan' ? elem.innerHTML = 'D'+ array[19] : elem.innerHTML = '---------';
    });
  }
  document.addEventListener('DOMContentLoaded', renew);
  setInterval(renew, 3000)
</script>
<!-- ********** end Script reception data*********** -->
<!-- ********************* -->
<!-- ********************* -->
<!-- ********************* -->
<!-- ********************* -->
<!-- ********************* -->
<!-- ********************* -->
<!-- ********************* -->
<!-- ********************* -->
<!-- ********************* -->
<!-- ********************* -->
<!-- ********************* -->
<!-- ********************* -->
<!-- ********************* -->
<!-- ********************* -->
<!-- ********************* -->

</html>
